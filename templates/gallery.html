{% extends "layout.html" %}
{% from "macros/nav-menu.html" import  render_menu with context %}
{% block title %}{{ this.title }}{% endblock %}

{% block extra_head %}

<script src="{{ '/static/js/imgPreload.js'|url }}"></script>

{% endblock %}

{% block nav %}
{{ render_menu() }}
{% endblock %}


{% block body %}

<h2>{{ this.name }}</h2>

{% set images = this.attachments.images.all() %}
{% if images %}


<!--<button id="lightbox" class="uk-button uk-button-default" type="button">Dynamic lightbox</button>-->

<!-- image list -->
<div id="lightbox-animation" class="uk-child-width-1-2@s uk-child-width-1-3@m uk-child-width-1-4@l uk-text-center"  uk-grid-parallax="translate:2000" uk-lightbox>
  {% for image in images %}
  <div > 
    <a class="uk-inline uk-panel uk-link-muted uk-text-center" href="{{ image|url }}">
      {# {% if image.caption -%} caption="{{ image.caption }}"{%- endif %} #}
      <figure>
        <img src="{{ image|url }}" width="400" alt="">
        {% if image.caption %}
        <figcaption class="uk-margin-small-top">{{ image.caption }}</figcaption>
        {% endif %}
      </figure>
    </a>
  </div>
  {% endfor %}

</div>
<!--

<script type="text/javascript">
  //<![CDATA[
  
  var img_json = [
    {%- for image in images %}
    {
    {%- set caption = image.caption|trim -%}
    {%- set description = image.description|trim -%}
    "id": "{{ image._id }}",
    "src": "{{ image|url }}",
    "width": {{ image.width }},
    "height": {{ image.height }}
    {%- if description %},
    "description": "{{ description }}"{% endif %}
    {%- if caption %},
    'caption': '{{ caption }}'{% endif %}
    }{% if not loop.last -%} ,{% endif %}
    {% endfor %}
  ];


  $('#lightbox').on('click', function (e) {
    e.preventDefault();

    UIkit.lightboxPanel({
      items: [
        {%- for image in images %}

        {source: '{{ image|url }}', caption: '{{image.caption|trim}}'}{% if not loop.last -%} ,{% endif %}
        {% endfor %}
      ]
    }).show();
  });
  //]]>
</script>
-->


{% endif %}

{% endblock %}
